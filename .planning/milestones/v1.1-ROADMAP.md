# Milestone v1.1: Pre-Pilot Hardening

**Status:** SHIPPED 2026-02-08
**Phases:** 6-10
**Total Plans:** 12

## Overview

Close all functional gaps identified in the codebase audit before UAT with real inspectors. Court-ready PDF output, complete notification pipeline, advanced filtering, and admin tooling.

## Phases

### Phase 6: PDF Court-Readiness

**Goal**: Generated PDF reports contain all ISO 17020 required sections and compliance assessment results, making them court-admissible without manual additions
**Depends on**: Nothing (builds on existing PDF infrastructure from v1.0)
**Requirements**: PDF-01, PDF-02, PDF-03, PDF-04, PDF-05
**Plans**: 2 plans

Plans:
- [x] 06-01-PLAN.md -- Add methodology and equipment form fields to report edit page
- [x] 06-02-PLAN.md -- Create PDF methodology section component and wire into report template

**Completed:** 2026-02-07

### Phase 7: Notifications & Sharing

**Goal**: Users receive timely email and push notifications for inspection workflow events, and shared reports enforce password protection
**Depends on**: Nothing (builds on existing notification stubs and sharing infrastructure from v1.0)
**Requirements**: NOTIF-01, NOTIF-02, NOTIF-03, SHARE-01
**Plans**: 2 plans

Plans:
- [x] 07-01-PLAN.md -- Wire assignment notifications (client confirmation email + inspector in-app/push/email)
- [x] 07-02-PLAN.md -- Wire review decision notifications + harden shared report password protection

**Completed:** 2026-02-07

### Phase 8: Search, Filtering & Templates

**Goal**: Users can efficiently find reports using multiple filter criteria and apply saved templates when creating new reports
**Depends on**: Nothing (builds on existing report list and template CRUD from v1.0)
**Requirements**: SRCH-01, SRCH-02, SRCH-03, SRCH-04, TMPL-01
**Plans**: 2 plans

Plans:
- [x] 08-01-PLAN.md -- Add severity, compliance, inspector, and date field filters to report list API and UI
- [x] 08-02-PLAN.md -- Wire template selection into report creation wizard

**Completed:** 2026-02-07

### Phase 9: Export, Bulk & Admin

**Goal**: Admins have production-ready tools for evidence packaging, bulk operations, notification lifecycle management, and API documentation
**Depends on**: Phase 6 (PDF generation must be complete before bulk PDF and ZIP export)
**Requirements**: PDF-06, PDF-07, NOTIF-04, NOTIF-05, API-01
**Plans**: 4 plans

Plans:
- [x] 09-01-PLAN.md -- Evidence package ZIP export (service + API + UI button)
- [x] 09-02-PLAN.md -- Bulk PDF generation + notification archiving
- [x] 09-03-PLAN.md -- Email template model, rendering service, and CRUD API
- [x] 09-04-PLAN.md -- Email template admin UI + OpenAPI/Swagger documentation

**Completed:** 2026-02-07

### Phase 10: Admin Polish & Email Template Wire-Up

**Goal**: Admin email template edits take effect on actual emails sent, admin dashboard provides full navigation, and admin reports page supports filtering
**Depends on**: Phase 9 (email template service and admin pages must exist)
**Gap Closure**: Closes 3 integration gaps from v1.1 audit
**Plans**: 2 plans

Plans:
- [x] 10-01-PLAN.md -- Wire all 8 email functions to use emailTemplateService.renderTemplate() with hardcoded fallback
- [x] 10-02-PLAN.md -- Add 3 admin dashboard quick action cards + refactor admin reports to use ReportSearch with batch PDF

**Completed:** 2026-02-08

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 6. PDF Court-Readiness | 2/2 | Complete | 2026-02-07 |
| 7. Notifications & Sharing | 2/2 | Complete | 2026-02-07 |
| 8. Search, Filtering & Templates | 2/2 | Complete | 2026-02-07 |
| 9. Export, Bulk & Admin | 4/4 | Complete | 2026-02-07 |
| 10. Admin Polish & Email Wire-Up | 2/2 | Complete | 2026-02-08 |

---

## Milestone Summary

**Key Decisions:**

- Equipment stored as string[] in DB, displayed as comma-separated text in form
- Methodology stored as plain string for simple textarea round-trip
- MethodologySection uses two Page elements: methodology on page 1, limitations on dedicated page 2
- All notifications are fire-and-forget with .catch() error handling
- Inspector receives both in-app notification AND email for assignments
- Compliance status filter uses post-fetch filtering due to nested JSON structure
- Email template service uses DB-first lookup with hardcoded fallback
- Hand-crafted OpenAPI spec rather than auto-generation (88 routes)
- Swagger UI loaded via dynamic import with SSR disabled
- renderTemplate() result used directly, wrapInTemplate() only in fallback paths
- BatchPdfPanel is fully self-contained with collapsible report checklist

**Issues Resolved:**

- All 12 gaps from initial codebase audit closed
- 3 integration gaps from milestone audit closed by Phase 10
- Email template system fully end-to-end functional

**Issues Deferred:**

- Notification archive has no UI trigger (API-only, designed for Vercel Cron)
- Pre-existing type errors in src/lib/validation.test.ts

**Technical Debt Incurred:**

- None significant

---

_For current project status, see .planning/ROADMAP.md_
